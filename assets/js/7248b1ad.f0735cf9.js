"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[29656],{93575:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});var t=s(86955),r=s(74848),i=s(43023);const a={id:"General_WSS_information",title:"General WSS information",sidebar_label:"General WSS information",sidebar_position:1},o=void 0,l={},c=[{value:"General WebSocket Information",id:"general-websocket-information",level:2},{value:"Request Headers",id:"request-headers",level:3},{value:"Subscription Steps",id:"subscription-steps",level:3},{value:"Request Message Format",id:"request-message-format",level:2},{value:"Response Message Format",id:"response-message-format",level:2},{value:"Push Message Format",id:"push-message-format",level:2},{value:"Heartbeat",id:"heartbeat",level:2},{value:"Error Codes",id:"error-codes",level:2},{value:"Order Book Management",id:"order-book-management",level:2},{value:"Notes",id:"notes",level:3}];function d(e){const n={code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"general-websocket-information",children:"General WebSocket Information"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Base URL"}),": ",(0,r.jsx)(n.code,{children:"wss://fstream.x.group/ws/market"})," ",(0,r.jsx)(n.em,{children:"(Public channels; no listenKey required)"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"request-headers",children:"Request Headers"}),"\n",(0,r.jsx)(n.p,{children:"When initiating the HTTP upgrade for the WebSocket connection, it is recommended to enable the per\u2011message compression extension:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",metastring:'title="Recommended Header"',children:"Sec-Websocket-Extensions: permessage-deflate\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"subscription-steps",children:"Subscription Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Establish a WebSocket connection."}),"\n",(0,r.jsx)(n.li,{children:"To subscribe to a public channel event, send:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="Subscribe"',children:'{\n  "method": "SUBSCRIBE",\n  "params": ["{topic}@{symbol_you_follow}"],\n  "id": "id_field_could_call_whatever_you_want"\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"request-message-format",children:"Request Message Format"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Subscribe / Unsubscribe example"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="Message format"',children:'{\n  "method": "SUBSCRIBE/UNSUBSCRIBE",\n  "params": ["{topic1}@{arg1},{arg2}", "{topic2}@{arg}"],\n  "id": "id_field_could_call_whatever_you_want" // callback ID\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"response-message-format",children:"Response Message Format"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="Response"',children:'{\n  "id": "{id}", // callback ID\n  "code": 1, // result 0=success; 1=failure; 2=listenKey invalid\n  "msg": ""\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"push-message-format",children:"Push Message Format"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="Format"',children:'{\n  "topic": "topic",\n  "event": "{topic}@{symbol}", // title\n  "data": {}\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="Example"',children:'{\n  "topic": "trade",\n  "event": "trade@btc_usdt",\n  "data": {\n    "s": "btc_usdt",\n    "i": 6316559590087222000,\n    "t": 1655992403617,\n    "p": "43000",\n    "q": "0.21",\n    "b": true\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"heartbeat",children:"Heartbeat"}),"\n",(0,r.jsxs)(n.p,{children:["Each client connection must periodically send a ",(0,r.jsx)(n.strong,{children:"text"})," ",(0,r.jsx)(n.code,{children:"ping"})," message. The server will reply with a ",(0,r.jsx)(n.strong,{children:"text"})," ",(0,r.jsx)(n.code,{children:"pong"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["If the server does not receive a ",(0,r.jsx)(n.code,{children:"ping"})," within ",(0,r.jsx)(n.strong,{children:"30 seconds"}),", it will proactively close the connection."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"error-codes",children:"Error Codes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Error code"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"400"}),(0,r.jsx)(n.td,{children:"Bad request payload. Please check it."})]})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"order-book-management",children:"Order Book Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"How to maintain a local order book correctly"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Connect to ",(0,r.jsx)(n.code,{children:"wss://fstream.xt.com/ws/market"}),", and subscribe to ",(0,r.jsx)(n.code,{children:"depth_update@btc_usdt"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Buffer the events received from the stream."}),"\n",(0,r.jsxs)(n.li,{children:["Fetch a depth snapshot: ",(0,r.jsx)(n.code,{children:"https://fapi.xt.com/future/market/v1/public/depth?symbol=btc_usdt&level=500"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Discard any event where ",(0,r.jsx)(n.code,{children:"u <= lastUpdateId"})," in the snapshot."]}),"\n",(0,r.jsxs)(n.li,{children:["The first processed event should satisfy ",(0,r.jsx)(n.code,{children:"fu <= lastUpdateId + 1"})," and ",(0,r.jsx)(n.code,{children:"u >= lastUpdateId + 1"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["While listening to the stream, each new event must have ",(0,r.jsx)(n.code,{children:"fu == previous.u + 1"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The data in each event is the ",(0,r.jsx)(n.strong,{children:"absolute"})," quantity at each price level."]}),"\n",(0,r.jsxs)(n.li,{children:["If the quantity is ",(0,r.jsx)(n.code,{children:"0"}),", remove that price level."]}),"\n",(0,r.jsx)(n.li,{children:"Receiving deletion of a price level that does not exist locally may happen and is normal."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(n.p,{children:["Because the depth snapshot limits the number of levels, levels that have ",(0,r.jsx)(n.strong,{children:"no changes"})," after the initial snapshot will not be updated in the incremental depth stream. Therefore, even if you apply all updates correctly, those levels will not appear in the local order book, which may cause minor differences from the actual order book. For most use cases, a 500\u2011level snapshot is sufficient to understand the market and trade effectively."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},43023:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(96540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}},86955:e=>{e.exports=JSON.parse('{"id":"futures/WebsocKetV2/General_WSS_information","title":"General WSS information","description":"General WebSocket Information","source":"@site/docs/futures/WebsocKetV2/General WSS information.mdx","sourceDirName":"futures/WebsocKetV2","slug":"/futures/WebsocKetV2/General_WSS_information","permalink":"/docs/futures/WebsocKetV2/General_WSS_information","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/edit/main/website/docs/futures/WebsocKetV2/General WSS information.mdx","tags":[],"version":"current","lastUpdatedBy":"enjuppa","lastUpdatedAt":1763440838000,"sidebarPosition":1,"frontMatter":{"id":"General_WSS_information","title":"General WSS information","sidebar_label":"General WSS information","sidebar_position":1},"sidebar":"futures","previous":{"title":"Message","permalink":"/docs/futures/UserWebsocket/Message"},"next":{"title":"Orderbook manage","permalink":"/docs/futures/WebsocKetV2/OrderbookManage"}}')}}]);